<!doctype html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DocuSign Handback</title>
<style>
  body { font: 16px/1.45 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif; padding: 24px; }
  .btn { display:inline-block; padding:12px 16px; border:1px solid #222; border-radius:10px; text-decoration:none; }
  code { background:#f4f4f4; padding:2px 6px; border-radius:6px }
  details { margin-top: 16px }
</style>
<script>
  // Helper: get a param by any of several names (case-insensitive variants)
  function getAny(names, qp) {
    for (const n of names) {
      const v = qp.get(n);
      if (v) return v;
    }
    return null;
  }

  const qp = new URLSearchParams(location.search);

  const event = getAny(['event','Event'], qp) || '(none)';
  const state = getAny(['state','State'], qp) || '(none)';
  // Accept DocuSign's envelopeId or our fallback eId (and common variants)
  const envelopeId =
    getAny(['envelopeId','EnvelopeId','envelopeID','eid','eId','EID','EId'], qp) || '(unknown)';

  // Build a tiny debug list of all params
  const allParams = Array.from(qp.entries())
    .map(([k,v]) => `${k}=${v}`)
    .join('&');

  document.addEventListener('DOMContentLoaded', () => {
    document.body.innerHTML = `
      <h2>DocuSign returned</h2>
      <p><strong>event</strong>: <code>${event}</code></p>
      <p><strong>state</strong>: <code>${state}</code></p>
      <p><strong>envelopeId</strong>: <code>${envelopeId}</code></p>

      <details>
        <summary>debug</summary>
        <p style="margin-top:8px"><code>${allParams || '(no query params)'}</code></p>
      </details>

      <p style="margin-top:20px">
        <a class="btn" href="https://guest.yourdomain.com/check-in">Return to Check-in</a>
      </p>
    `;
  });
</script>

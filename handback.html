<!doctype html>
<!-- v3 -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DocuSign Handback</title>
<style>
  body { font: 16px/1.45 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif; padding: 24px; }
  .btn { display:inline-block; padding:12px 16px; border:1px solid #222; border-radius:10px; text-decoration:none; }
  code { background:#f4f4f4; padding:2px 6px; border-radius:6px }
  .raw { margin-top: 12px; font-size: 14px; }
</style>
<script>
  // Prefer ?svr=... from the URL (set by the server) to avoid editing this file when ngrok changes
const qp0 = new URLSearchParams(location.search);
const HANDOFF_BASE = qp0.get('svr') || 'https://2d5698bfafa3.ngrok-free.app';


  // Helper: get a param by any of several names (case-insensitive variants)
  function getAny(names, qp) {
    for (const n of names) {
      const v = qp.get(n);
      if (v) return v;
    }
    return null;
  }

  const qp = new URLSearchParams(location.search);

  const event = getAny(['event','Event'], qp) || '(none)';
  const state = getAny(['state','State'], qp) || '(none)';           // this is your visitId
  const envelopeId = getAny(['envelopeId','EnvelopeId','envelopeID','eid','eId','EID','EId'], qp) || '(unknown)';

  // Build a tiny debug list of all params
  const allParams = Array.from(qp.entries()).map(([k,v]) => `${k}=${v}`).join('&');

  async function pollReady() {
    if (!state || state === '(none)') return; // no visitId to poll
    const readyEl = document.getElementById('ready-status');

